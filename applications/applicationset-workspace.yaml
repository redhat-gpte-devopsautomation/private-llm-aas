---
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: workspace
  namespace: openshift-gitops
spec:
  generators:
  - list:
      elements:
      - user: user1
      - user: user2
  template:
    metadata:
      name: workspace-{{ user }}
      namespace: openshift-gitops
    spec:
      project: default
      source:
        repoURL: https://github.com/rhpds/private-llmaas-multitenant
        targetRevision: taylor-testing
        path: workspace
        helm:
          values: |
            username: '{{ user }}'
            devworkspace:
              # name will be auto-generated as llmaas-{username} if not specified
              devfile: http://devspaces-dashboard.openshift-devspaces.svc.cluster.local:8080/dashboard/api/editors/devfile?che-editor=che-incubator/che-code/latest
              projects:
                repoUrl: https://github.com/taylorjordanNC/coding-exercises
                revision: main
              components:
                - name: tooling
                  container:
                    image: registry.redhat.io/devspaces/udi-rhel9:3.21
                    sourceMapping: /projects
      destination:
        server: https://kubernetes.default.svc
      syncPolicy:
        automated: {}
